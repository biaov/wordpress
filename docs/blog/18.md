# æœåŠ¡å™¨ä½¿ç”¨ Docker ä»é›¶éƒ¨ç½² Vue é¡¹ç›®

## å‰æ

* ä¸€å°æœåŠ¡å™¨ ( Linux å†…æ ¸ç³»ç»Ÿ - CentOS 8 ä¸ºä¾‹ )ï¼Œå¦‚æœæ˜¯æœ¬åœ°è£… docker æ¨¡æ‹Ÿçš„è¯ï¼Œè·³è¿‡æ­¤é˜¶æ®µ
* äº†è§£ docker ç®€å•æ¦‚å¿µï¼ŒLinux ç®€å•æ“ä½œ

::: warning æ³¨æ„
æœåŠ¡å™¨ä¿è¯å¯ä»¥æ­£å¸¸è¿æ¥è®¿é—®ï¼Œå›½å†…çš„å·²å¤‡æ¡ˆï¼Œå¹¶å¼€æ”¾äº†ç«¯å£
:::

### é¢˜å¤–è¯-æœåŠ¡å™¨é‡è£…ç³»ç»Ÿï¼ˆä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼‰

1. ç™»å½•é˜¿é‡Œäº‘è´¦å·ï¼Œå³ä¸Šè§’æ‰“å¼€æ§åˆ¶å°
![å›¾ç‰‡](https://img-blog.csdnimg.cn/20210422183634269.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JpYW9fZmVuZw==,size_16,color_FFFFFF,t_70#pic_center)
2. æ‰¾åˆ°äº‘æœåŠ¡å™¨ ECSï¼ˆç‚¹å‡»å·¦ä¾§æ ç›®ï¼‰ï¼Œåœæ­¢æœåŠ¡å™¨ï¼ˆå®ä¾‹ï¼‰
![å›¾ç‰‡](https://img-blog.csdnimg.cn/20210422183709477.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JpYW9fZmVuZw==,size_16,color_FFFFFF,t_70#pic_center)
3. ç‚¹å‡»å·¦ä¾§å®ä¾‹ï¼Œç‚¹å‡»åˆ—è¡¨æ›´å¤š > äº‘ç›˜å’Œé•œåƒ > æ›´æ¢æ“ä½œç³»ç»Ÿ
![å›¾ç‰‡](https://img-blog.csdnimg.cn/20210422183911872.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JpYW9fZmVuZw==,size_16,color_FFFFFF,t_70#pic_center)

* æ¥ä¸‹æ¥è¿›å…¥æ­£é¢˜

## å®‰è£… docker

### è¿æ¥æœåŠ¡å™¨ï¼Œè¿™é‡Œç”¨çš„ xshell

* æ‰“å¼€ xshellï¼Œç‚¹å‡»å·¦ä¸Šè§’æ–°å»ºï¼Œè¾“å…¥ IP åœ°å€ > è´¦å· ( root ) å’Œå¯†ç ï¼ˆé‡è£…ç³»ç»Ÿçš„æ—¶å€™è®¾ç½®çš„ï¼‰

### è¾“å…¥å®‰è£…å‘½ä»¤

```Basic
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
```

### æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ

```Basic
docker -v
```

![å›¾ç‰‡](https://img-blog.csdnimg.cn/20210422183924446.png#pic_center)

::: tip æˆåŠŸ
æ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œå®‰è£…æˆåŠŸ
:::

## é…ç½® nginx web æœåŠ¡å™¨

### ä¸‹è½½ nginx é•œåƒ

```Basic
docker pull nginx:latest
```

### å¯åŠ¨ä¸€ä¸ªæ¥è‡ªäº nginx é•œåƒçš„ docker å®¹å™¨

* å¦‚ä½•ä½ å·²ç»æœ‰äº† nginx é…ç½®æ–‡ä»¶åˆ™çœç•¥æ­¤æ­¥éª¤ï¼Œå¦‚ä½•æ²¡æœ‰ï¼Œåˆ™æŒ‰ä»¥ä¸‹æ­¥éª¤æ¥å¤åˆ¶é»˜è®¤é…ç½®

#### åˆ›å»ºå¹¶å¯åŠ¨ä¸´æ—¶çš„å®¹å™¨

```Basic
docker run --name temp-nginx 8080:80 -d nginx
```

* æ‰“å¼€åœ°å€æŸ¥çœ‹ï¼Œip:8080ï¼Œå¦‚æœæœ‰é¡µé¢ï¼Œåˆ™è¡¨ç¤º nginx éƒ¨ç½²æˆåŠŸï¼Œå¦‚æœæ²¡æœ‰åˆ™è¡¨ç¤ºéƒ¨ç½²å¤±è´¥æˆ–è€… nginx é•œåƒä¸‹è½½å¤±è´¥
* å¤±è´¥åŸå› å¯»æ‰¾ï¼š
  * nginx é•œåƒä¸‹è½½å¤±è´¥ï¼šå‘½ä»¤ `docker images` æŸ¥çœ‹æ˜¯å¦ä¸‹è½½æˆåŠŸï¼Œæ²¡æœ‰åˆ™é‡æ–°ä¸‹è½½
  * éƒ¨ç½²å¤±è´¥ï¼šå‘½ä»¤ `docker logs temp-nginx` æŸ¥çœ‹é”™è¯¯æ—¥å¿—ä¿¡æ¯

#### å¤åˆ¶é…ç½®

* æ–°å»ºå­˜æ”¾ç›®å½• `mkdir -p /docker/nginx`
* æŠŠé…ç½®å¤åˆ¶åˆ° `/docker/nginx` ç›®å½•ä¸‹
  * `docker cp temp-nginx:/etc/nginx/nginx.conf /docker/nginx`
  * `docker cp -a temp-nginx:/usr/share/nginx/html /docker/nginx`
  * å…¶ä»–æ–‡ä»¶å¦‚æ—¥å¿—ï¼Œå¯ä»¥åé¢è‡ªå·±å†å»æ“ä½œï¼Œè¿™é‡ŒåªåšåŸºæœ¬éƒ¨ç½²

#### åˆ é™¤ä¸´æ—¶å®¹å™¨

```Basic
docker rm -f temp-nginx
```

#### ä¿®æ”¹ nginx.conf é…ç½®

* `vi /docker/nginx/nginx.conf`
* æ³¨é‡Š `include /etc/nginx/conf.d/*.conf;` è¿™æ®µè¯ï¼Œä¸ç„¶ä»–ä¼šå¼•å…¥ conf.d é‡Œçš„é…ç½®
  * å½“ç„¶ï¼Œå¦‚æœä½ ä¸æƒ³æ³¨é‡Šçš„è¯ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„æ–¹æ³•å¤åˆ¶ conf.d æ–‡ä»¶å¤¹ï¼Œåé¢è®°å¾—åŠ ä¸ªæ˜ å°„å°±è¡Œ
* åœ¨åŸæ–‡ä»¶çš„åŸºç¡€ä¸ŠåŠ ä¸Š `server`

<details>
<summary>ğŸ‘€ æŸ¥çœ‹ nginx.conf è¯¦æƒ…</summary>

```Conf
user  nginx;
worker_processes  1;
error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;
events {
    worker_connections  1024;
}
http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
    access_log  /var/log/nginx/access.log  main;
    sendfile        on;
    keepalive_timeout  65;
    # æ³¨é‡Šä¸‹é¢è¿™æ®µï¼Œä¸ç„¶ä»–ä¼šå¼•å…¥conf.dé‡Œçš„é…ç½®
    # include /etc/nginx/conf.d/*.conf;
    # æ–‡ä»¶é‡Œé¢æ‰€æœ‰çš„è·¯å¾„éƒ½è¦å†™å®¹å™¨é‡Œçš„è·¯å¾„ï¼Œä¸è¦å†™æœ¬åœ°è·¯å¾„ï¼Œä¸ç„¶ä¼šæ‰¾ä¸åˆ°æ–‡ä»¶
    # æ‰€ä»¥åé¢ä¼šæŠŠæœ¬åœ°è·¯å¾„æ˜ å°„åˆ°å®¹å™¨è·¯å¾„
    # æ¯”å¦‚ /usr/share/nginx/html å…¶å®ä¼šè®¿é—® /docker/nginx/html ç›®å½•
    # å¼€å¯æœåŠ¡
    server {
        listen       80;
        server_name  biaov.cn;
        location / {
            # vueæ–‡ä»¶å­˜æ”¾ç›®å½•
            # æ³¨æ„è¿™é‡Œä¸€å®šæ˜¯å®¹å™¨è·¯å¾„ï¼Œä¸èƒ½æ˜¯æœ¬åœ°è·¯å¾„
            root   /usr/share/nginx/html;
            index  index.html index.htm;
        }
    }
}
```

</details>

#### åˆ›å»ºæ˜ å°„çš„å®¹å™¨

```Basic
docker run -d --name nginx-http -p 80:80 -v /docker/nginx/html:/usr/share/nginx/html -v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf nginx
```

### ä¸Šä¼  Vue æ–‡ä»¶

* è¿™é‡Œä½¿ç”¨ FlashFXP ä¸Šä¼ ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ Xshell çš„ ftp ä¸Šä¼ 

![å›¾ç‰‡](https://img-blog.csdnimg.cn/20210422184023959.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JpYW9fZmVuZw==,size_16,color_FFFFFF,t_70#pic_center)

* æŠŠ Vue æ–‡ä»¶ä¸Šä¼ åˆ°è¿™ä¸ªç›®å½•å³å¯

![å›¾ç‰‡](https://img-blog.csdnimg.cn/20210422184035728.png#pic_center)

* ç”¨åŸŸåæˆ– ip æŸ¥çœ‹ä¸‹ï¼Œå¦‚ [biaov.cn](https://biaov.cn/)

::: tip å®Œæˆ
éƒ¨ç½²å®Œæˆ
:::

* é¢˜å¤–è¯-éƒ¨ç½² SSL è¯ä¹¦æµç¨‹
* é˜¿é‡Œäº‘ä¸‹è½½ nginx çš„ SSl è¯ä¹¦(åŸŸåè¦ä¸€è‡´)
* nginx.conf é…ç½® 443 ç«¯å£ï¼ˆè¯ä¹¦è®¿é—®åœ°å€è®°å¾—åšæ˜ å°„ï¼‰

```Conf
server {
    listen       443 ssl;
    server_name  biaov.cn;
    ssl_certificate      /etc/nginx/cert/biaov/biaov.cn.pem;
    ssl_certificate_key  /etc/nginx/cert/biaov/biaov.cn.key;
    ssl_session_cache    shared:SSL:1m;
    ssl_session_timeout  5m;
    ssl_ciphers  HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers  on;
    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }
}
```

* docker åˆ›å»ºå¹¶å¼€å¯ 443 ç«¯å£çš„å®¹å™¨

```Basic
docker run -d --name nginx-https -p 443:443 -v /docker/nginx/html:/usr/share/nginx/html -v /docker/nginx/nginx.conf:/etc/nginx/nginx.conf /docker/nginx/certs:/etc/nginx/cert -v /docker/nginx/config:/etc/nginx/config nginx
```

* å‚è€ƒæ•™ç¨‹: [Docker æ•™ç¨‹](https://www.runoob.com/docker/docker-tutorial.html)
